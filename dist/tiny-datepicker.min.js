!function(t){var e="object"==typeof window&&window||"object"==typeof self&&self;"undefined"==typeof module||"undefined"==typeof exports||exports.nodeType?e&&(e.tinyDatePicker=t(),"function"==typeof define&&define.amd&&define([],function(){return e.tinyDatePicker})):module.exports=t()}(function(){function l(t){for(var e=""+t,a=e.length;a++<2;)e="0"+e;return e}function k(t,e){return new Date(t,e-1,1)}function _(t,e){return new Date(t,e-1,0)}function M(t,e){return new Date(t,e,0).getDate()}function u(t){var e="scroll"+t[0].toUpperCase()+t.slice(1);return document.documentElement&&document.documentElement[e]?document.documentElement[e]:document.body[e]}function $(t){return null!==t&&"undefined"!==t&&(!isNaN(new Date(t).getTime())&&!Array.isArray(t))}function h(t){var e=[];if("string"==typeof t)for(var a=document.querySelectorAll(t),i=0,n=a.length;i<n;i++)e.push(a[i]);else if(t instanceof NodeList||t instanceof HTMLCollection)for(var s=0,r=t.length;s<r;s++)e.push(t[i]);else{if(!(t&&"object"==typeof t&&t instanceof HTMLElement))throw new Error("Invalid selector for tiny date picker!");e.push(t)}return e}var t={clearable:!1,daysOfWeekDisabled:[],disabledDate:null,defaultValue:null,format:"yyyy-mm-dd",lang:"zh-CN",showWeekDays:!0,templates:null,weekStart:0,zIndex:2019},i=/dd?|DD?|mm?|MM?|yy(?:yy)?/g,d=Math.random().toString(36).substr(2);function s(t,e){this.$el=t,this.$input="input"===t.tagName.toLowerCase()?t:t.querySelector("input"),this.options=e||{},this.$datePicker=null,this.value=null,this.state={isVisible:!1,isMounted:!1,showStatus:0,weekData:[],dateData:[],monthData:[],yearData:[],date:null,month:null,year:null},this.handleShow=this.onShow.bind(this),this.handleKeyDown=this.onKeyDown.bind(this),this.handleHide=this.onHide.bind(this),this.register()}s.prototype.register=function(){var t,e;t=this.$el,e=this,t["datepicker"+d]=e,this.addEventListener()},s.prototype.init=function(){this.initOptions(),this.initData(),this.initDom(),this.render(),this.initEvent()},s.prototype.initOptions=function(){this.settings=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),a=1;a<arguments.length;a++){var i=arguments[a];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}({},t,this.options)},s.prototype.initData=function(){this.initWeekData(),this.initDateData(),this.initMonthData(),this.initYearData()},s.prototype.initWeekData=function(){for(var t=this.getI18n().daysMin,e=this.getWeekStart(),a=0;a<e;a++)t.push(t.shift());this.state.weekData=t},s.prototype.initDateData=function(){var t=this.state.year,e=this.state.month;if(!t||!e){var a=this.settings.defaultValue,i=null;t=(i=$(a)?new Date(a):new Date).getFullYear(),e=i.getMonth()+1}var n=k(t,e),s=k(t,e).getDay();e=n.getMonth()+1;var r=_(t=n.getFullYear(),e),o=_(t,e).getDate(),h=r.getMonth()+1,l=r.getFullYear(),d=M(t,e),c=new Date(t,e,1),p=c.getMonth()+1,u=c.getFullYear(),y=6,f=this.getWeekStart();if(this.state.dateData=[],s===f){for(var g=0;g<7;g++)this.state.dateData.push({day:(g+f)%7,date:o-7+g+1,month:h,year:l});y--}for(var D=Math.abs(s-f+7)%7,v=0;v<7*y;v++){var b,w,m;m=v<D?(b=o-D+v+1,w=h,l):d+D-1<v?(b=v-d-D+1,w=p,u):(b=v-D+1,w=e,t),this.state.dateData.push({day:(v+f)%7,date:b,month:w,year:m})}this.state.month=e,this.state.year=t},s.prototype.initMonthData=function(){var t=this.getI18n().monthsShort;this.state.monthData=t.map(function(t,e){return{label:t,value:e+1}})},s.prototype.initYearData=function(){var t=this.state.year,e=t-t%10;this.state.yearData=[];for(var a=0;a<10;a++)this.state.yearData.push(e+a)},s.prototype.initDom=function(){var t=this.getI18n(),e=t.today,a=t.clear,i=t.titleExchange,n=this.settings,s=n.clearable,r=n.templates,o="&lt;&lt;",h="&lt;",l="&gt;&gt;",d="&gt;";r&&(o=r.prevYearArrow||o,h=r.prevMonthArrow||h,l=r.nextYearArrow||l,d=r.nextMonthArrow||d);var c=['<div class="tiny-datepicker__header">','<button class="tiny-datepicker__btn tiny-datepicker__prev-btn tiny-datepicker__prev-year">'+o+"</button>",'<button class="tiny-datepicker__btn tiny-datepicker__prev-btn tiny-datepicker__prev-month">'+h+"</button>",'<span class="tiny-datepicker__header-label tiny-datepicker__show-year"></span>','<span class="tiny-datepicker__header-label tiny-datepicker__show-month"></span>','<button class="tiny-datepicker__btn tiny-datepicker__next-btn tiny-datepicker__next-year">'+l+"</button>",'<button class="tiny-datepicker__btn tiny-datepicker__next-btn tiny-datepicker__next-month">'+d+"</button>","</div>",'<div class="tiny-datepicker__body">','<table class="tiny-datepicker__table tiny-datepicker__date-table">',"<thead></thead>","<tbody></tbody>","</table>",'<table class="tiny-datepicker__table tiny-datepicker__month-table">',"<tbody></tbody>","</table>",'<table class="tiny-datepicker__table tiny-datepicker__year-table">',"<tbody></tbody>","</table>","</div>",'<div class="tiny-datepicker__footer" style="display: '+(s?"block":"none")+'">','<button class="tiny-datepicker__footer-btn tiny-datepicker__now-btn"><span>'+e+"</span></button>",'<button class="tiny-datepicker__footer-btn tiny-datepicker__clear-btn"><span>'+a+"</span></button>","</div>"];if(i){var p=c[3];c[3]=c[4],c[4]=p}var u=document.createElement("div");u.className="tiny-datepicker__wrapper",u.innerHTML=c.join(""),this.$datePicker=u,this.$showYear=this.getDom(".tiny-datepicker__show-year"),this.$showMonth=this.getDom(".tiny-datepicker__show-month"),this.$dateTable=this.getDom(".tiny-datepicker__date-table"),this.$monthTable=this.getDom(".tiny-datepicker__month-table"),this.$yearTable=this.getDom(".tiny-datepicker__year-table"),this.$prevYear=this.getDom(".tiny-datepicker__prev-year"),this.$prevMonth=this.getDom(".tiny-datepicker__prev-month"),this.$nextMonth=this.getDom(".tiny-datepicker__next-month"),this.$nextYear=this.getDom(".tiny-datepicker__next-year"),this.$datePickerFooter=this.getDom(".tiny-datepicker__footer"),this.$nowBtn=this.getDom(".tiny-datepicker__now-btn"),this.$clearBtn=this.getDom(".tiny-datepicker__clear-btn")},s.prototype.addEventListener=function(){this.$input.addEventListener("focus",this.handleShow),this.$input.addEventListener("click",this.handleShow),this.$input.addEventListener("keydown",this.handleKeyDown),document.addEventListener("click",this.handleHide)},s.prototype.removeEventListener=function(){this.$input.removeEventListener("focus",this.handleShow),this.$input.removeEventListener("click",this.handleShow),this.$input.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("click",this.handleHide)},s.prototype.onShow=function(){this.state.isVisible||(this.state.isMounted?(this.changeView(0),this.renderForShowStatus(),this.show()):this.init(),this.adjustPosition())},s.prototype.onHide=function(t){var e=t.target;this.state.isVisible&&this.isInvalidClick(e)&&(this.hide(),this.blur())},s.prototype.show=function(){this.$datePicker&&(this.$datePicker.style.display="block",this.state.isVisible=!0)},s.prototype.hide=function(){this.$datePicker&&(this.$datePicker.style.display="none",this.state.isVisible=!1)},s.prototype.blur=function(){var t,e=this.$input.value,a=this.value;a&&$(a)?e&&$(e)?(t=e,new Date(new Date(a).setHours(0,0,0,0)).getTime()!==new Date(new Date(t).setHours(0,0,0,0)).getTime()&&this.setDate(e)):this.setDate(a):e&&$(e)?this.setDate(e):this.setDate(null)},s.prototype.onKeyDown=function(t){var e=t.keyCode,a=this;27===e&&(a.hide(),a.blur()),9===e&&setTimeout(function(){this.$input!==document.activeElement&&(a.hide(),a.blur())},0)},s.prototype.adjustPosition=function(){var t=this.$el.getBoundingClientRect(),e=this.$datePicker.getBoundingClientRect(),a=t.top,i=t.left,n=t.bottom,s=t.right-i,r=n-a,o=e.right-e.left,h=e.bottom-e.top,l=u("top"),d=u("left"),c=window.innerWidth,p="tiny-datepicker__wrapper tiny-datepicker__";window.innerHeight<a+h+8?(this.$datePicker.style.top=a-h+l-8+"px",p+="top"):(this.$datePicker.style.top=a+r+l+8+"px",p+="bottom"),c<i+o?(this.$datePicker.style.left=i-o+s+d+"px",p+="-right"):(this.$datePicker.style.left=i+d+"px",p+="-left"),this.settings.clearable&&(p+=" tiny-datepicker__clearable"),this.$datePicker.className=p,this.$datePicker.style.zIndex=this.settings.zIndex},s.prototype.render=function(){this.renderWeekData(),this.renderDateData(),this.renderMonthData(),this.renderYearData(),this.changeView(this.state.showStatus),this.mount()},s.prototype.mount=function(){this.state.isVisible=!0,this.state.isMounted=!0,document.body.appendChild(this.$datePicker)},s.prototype.renderWeekData=function(){if(this.settings.showWeekDays){var t=[],e=this.state.weekData;t.push("<tr>");for(var a=0,i=e.length;a<i;a++)t.push("<th>"+e[a]+"</th>");t.push("</tr>"),this.$dateTable.querySelector("thead").innerHTML=t.join("")}},s.prototype.renderDateData=function(){for(var t=[],e=this.state.dateData,a=0,i=e.length;a<i;a++){var n=e[a],s=this.getDateTdClass(n);a%7==0&&t.push("<tr>"),t.push('<td class="'+s+'"><span>'+n.date+"</span></td>"),a%7==6&&t.push("</tr>")}this.$dateTable.querySelector("tbody").innerHTML=t.join("")},s.prototype.reRenderDateData=function(){for(var t=this.state.dateData,e=this.$dateTable.querySelectorAll("tbody tr td"),a=0,i=t.length;a<i;a++){var n=t[a],s=e[a];s.className=this.getDateTdClass(n),s.innerHTML="<span>"+n.date+"</span>"}this.changeDateTableHeaderView()},s.prototype.getDateTdClass=function(t){var e=this.state.year,a=this.state.month,i="";if(t.month<a&&t.year<=e)i="prev-month";else if(t.month===a&&t.year===e){i="available";var n=new Date;n.getFullYear()===e&&n.getMonth()+1===a&&n.getDate()===t.date&&(i+=" today"),this.value&&this.value.getFullYear()===e&&this.value.getMonth()+1===a&&this.value.getDate()===t.date&&(i+=" selected")}else i="next-month";var s=this.settings,r=s.daysOfWeekDisabled||[],o=s.disabledDate;return-1<r.indexOf(t.day)?i+=" disabled":o&&"function"==typeof o&&o(new Date(t.year,t.month,t.date,0,0,0,0))&&(i+=" disabled"),i},s.prototype.renderMonthData=function(){for(var t=[],e=this.state.monthData,a=0,i=e.length;a<i;a++){var n=this.getMonthTdClass(e[a]);a%4==0&&t.push("<tr>"),t.push('<td class="'+n+'"><span>'+e[a].label+"</span></td>"),a%4==3&&t.push("</tr>")}this.$monthTable.querySelector("tbody").innerHTML=t.join("")},s.prototype.reRenderMonthData=function(){for(var t=this.state.monthData,e=this.$monthTable.querySelectorAll("tbody tr td"),a=0,i=t.length;a<i;a++){e[a].className=this.getMonthTdClass(t[a])}this.changeMonthTableHeaderView()},s.prototype.getMonthTdClass=function(t){var e=this.state.year,a="available",i=new Date;return i.getFullYear()===e&&i.getMonth()+1===t.value&&(a+=" today"),this.value&&this.value.getFullYear()===e&&this.value.getMonth()+1===t.value&&(a+=" selected"),a},s.prototype.renderYearData=function(){for(var t=[],e=this.state.yearData,a=0;a<12;a++){var i=this.getYearTdClass(e[a]);a%4==0&&t.push("<tr>"),t.push('<td><span class="'+i+'">'+(e[a]||"")+"</span></td>"),a%4==3&&t.push("</tr>")}this.$yearTable.querySelector("tbody").innerHTML=t.join("")},s.prototype.reRenderYearData=function(){for(var t=this.state.yearData,e=this.$yearTable.querySelectorAll("tbody tr td"),a=0,i=t.length;a<i;a++){var n=t[a],s=e[a];s.className=this.getYearTdClass(n),s.innerHTML="<span>"+n+"</span>"}this.changeYearTableHeaderView()},s.prototype.getYearTdClass=function(t){var e="available";return(new Date).getFullYear()===t&&(e+=" today"),this.value&&this.value.getFullYear()===t&&(e+=" selected"),e},s.prototype.initEvent=function(){this.$showMonth.addEventListener("click",this.changeMonthView.bind(this)),this.$showYear.addEventListener("click",this.changeYearView.bind(this)),this.$prevYear.addEventListener("click",this.doPrevYear.bind(this)),this.$prevMonth.addEventListener("click",this.doPrevMonth.bind(this)),this.$nextMonth.addEventListener("click",this.doNextMonth.bind(this)),this.$nextYear.addEventListener("click",this.doNextYear.bind(this)),this.$nowBtn.addEventListener("click",this.setTodayValue.bind(this)),this.$clearBtn.addEventListener("click",this.doClearDate.bind(this)),this.initChooseEvent()},s.prototype.initChooseEvent=function(){for(var t=[this.$dateTable,this.$monthTable,this.$yearTable],e=["onChooseDate","onChooseMonth","onChooseYear"],a=0,i=t.length;a<i;a++)for(var n=t[a].querySelectorAll("tbody tr td"),s=0,r=n.length;s<r;s++)n[s].addEventListener("click",this[e[a]].bind(this,s,n[s]))},s.prototype.onChooseDate=function(t,e){if(!(-1<e.className.search(/\bdisabled\b/))){var a=this.state.dateData[t],i=new Date(a.year,a.month-1,a.date);this.setDate(i),this.hide()}},s.prototype.onChooseMonth=function(t){var e=this.state.monthData[t].value;this.state.month=e,this.changeDateView()},s.prototype.onChooseYear=function(t){var e=this.state.yearData[t];this.state.year=e,this.changeMonthView()},s.prototype.toggleMonthBtnView=function(e){[this.$showMonth,this.$prevMonth,this.$nextMonth].forEach(function(t){t.style.display=e?"":"none"})},s.prototype.changeDateView=function(){this.changeView(0),this.renderForShowStatus()},s.prototype.changeDateTableHeaderView=function(){this.isDateView()&&(this.$showYear.innerHTML=this.formatYear(this.state.year),this.$showMonth.innerHTML=this.formatMonth(this.state.year,this.state.month))},s.prototype.changeMonthView=function(){this.changeView(1),this.renderForShowStatus()},s.prototype.changeMonthTableHeaderView=function(){this.isMonthView()&&(this.$showYear.innerHTML=this.formatYear(this.state.year))},s.prototype.changeYearView=function(){this.changeView(2),this.renderForShowStatus()},s.prototype.changeYearTableHeaderView=function(){if(this.isYearView()){var t=this.state.yearData,e=t[0],a=t[t.length-1];this.$showYear.innerHTML=this.formatYear(e)+" - "+this.formatYear(a)}},s.prototype.changeView=function(a){switch(this.state.showStatus=a,[this.$dateTable,this.$monthTable,this.$yearTable].forEach(function(t,e){t.style.display=e===a?"":"none"}),a){case 0:this.changeDateTableHeaderView();break;case 1:this.changeMonthTableHeaderView();break;case 2:this.changeYearTableHeaderView()}this.toggleMonthBtnView(0===a)},s.prototype.doPrevMonth=function(){this.isDateView()&&(--this.state.month,this.renderForShowStatus())},s.prototype.doNextMonth=function(){this.isDateView()&&(this.state.month+=1,this.renderForShowStatus())},s.prototype.doPrevYear=function(){switch(this.state.showStatus){case 0:case 1:--this.state.year;break;case 2:this.state.year-=10}this.renderForShowStatus()},s.prototype.doNextYear=function(){switch(this.state.showStatus){case 0:case 1:this.state.year+=1;break;case 2:this.state.year+=10}this.renderForShowStatus()},s.prototype.renderForShowStatus=function(){var t=this.state.showStatus;switch(t){case 0:this.initDateData(),this.reRenderDateData();break;case 1:this.initMonthData(),this.reRenderMonthData();break;case 2:this.initYearData(),this.reRenderYearData()}this.toggleMonthBtnView(0===t)},s.prototype.setTodayValue=function(){var t=new Date,e=this.settings.disabledDate;e&&"function"==typeof e&&e(new Date(t.setHours(0,0,0,0)))||(this.setDate(t),this.hide())},s.prototype.doClearDate=function(){this.clearDate(),this.hide()},s.prototype.clearDate=function(){this.setDate(null)},s.prototype.setDate=function(t){var e=null;$(t)&&(e=new Date(t)),this.state.year=e&&e.getFullYear(),this.state.month=e&&e.getMonth()+1,this.state.date=e&&e.getDate(),this.value=e,this.$input.value=this.formatDate(e,this.getFinalValue("format")),this.changeView(0),this.renderForShowStatus()},s.prototype.parseFormat=function(t){var e=t.replace(i,"\0").split("\0"),a=t.match(i);if(!e||!e.length||!a||0===a.length)throw new Error("Invalid date format.");return{separators:e,parts:a}},s.prototype.getDate=function(){return this.value},s.prototype.formatDate=function(t,e){if(!t)return t;if("timestamp"===e)return t.getTime();for(var a=this.parseFormat(e),i=this.getI18n(),n={d:t.getDate(),dd:l(t.getDate()),D:i.daysShort[t.getDay()],DD:i.days[t.getDay()],m:t.getMonth()+1,mm:l(t.getMonth()+1),M:i.monthsShort[t.getMonth()],MM:i.months[t.getMonth()],yy:t.getFullYear().toString().substring(2),yyyy:t.getFullYear()},s=[],r=a.separators||[],o=0,h=a.parts.length;o<=h;o++)r.length&&s.push(r.shift()),s.push(n[a.parts[o]]);return s.join("")},s.prototype.formatYear=function(t){var e=this.getI18n().yearTitle;return this.formatDate(new Date(t,0,1),e)},s.prototype.formatMonth=function(t,e){var a=this.getI18n().monthTitle;return this.formatDate(new Date(t,e-1,1),a)},s.prototype.getWeekStart=function(){var t=parseInt(Math.abs(this.getFinalValue("weekStart")))%7;return isNaN(t)?0:t},s.prototype.isDateView=function(){return 0===this.state.showStatus},s.prototype.isMonthView=function(){return 1===this.state.showStatus},s.prototype.isYearView=function(){return 2===this.state.showStatus},s.prototype.getDom=function(t){return this.$datePicker.querySelector(t)},s.prototype.isInvalidClick=function(t){for(var e=t;e;){if(e===this.$datePicker||e===this.$el)return!1;e=e.parentNode}return!0},s.prototype.getI18n=function(){return e.langs[this.settings.lang||"zh-CN"]},s.prototype.getFinalValue=function(t){var e=this.getI18n();return null!=this.options[t]?this.options[t]:null!=e[t]?e[t]:this.settings[t]},s.prototype.remove=function(){this.$datePicker.parentElement.removeChild(this.$datePicker)};var e={langs:{"zh-CN":{days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["周日","周一","周二","周三","周四","周五","周六"],daysMin:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今天",clear:"清除",format:"yyyy-mm-dd",yearTitle:"yyyy年",monthTitle:"mm月",titleExchange:!(s.prototype.destroy=function(){this.hide(),this.removeEventListener(),this.remove(),delete this["datepicker"+d]}),weekStart:1}},init:function(t,e){for(var a=h(t),i=0,n=a.length;i<n;i++)new s(a[i],e)},proxy:function(t,e){for(var a=h(t),i=Array.prototype.slice.call(arguments,2),n=[],s=0,r=a.length;s<r;s++){var o=a[s]["datepicker"+d];o&&n.push(o[e].apply(o,i))}return n},destroy:function(t){this.proxy(t,"destroy")},show:function(t){this.proxy(t,"onShow")},hide:function(t){this.proxy(t,"hide")},setDate:function(t,e){this.proxy(t,"setDate",e)},getDate:function(t){return this.proxy(t,"getDate")},clearDate:function(t){this.proxy(t,"clearDate")}};return e});